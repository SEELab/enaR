<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Uncertainty Analysis: Simplest Example • enaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Uncertainty Analysis: Simplest Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">enaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/enaR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/enterData.html">Entering your Data</a></li>
    <li><a class="dropdown-item" href="../articles/flow_simple.html">Flow Analysis: Simple</a></li>
    <li><a class="dropdown-item" href="../articles/structure_advanced.html">Structure Analysis: Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/structure_simple.html">Structure Analysis: Simple</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_simple.html">Uncertainty Analysis: Simplest Example</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_symmetric.html">Uncertainty Analysis: Symmetric Values</a></li>
    <li><a class="dropdown-item" href="../articles/utility.html">Utility and Mixed Trophic Analyses</a></li>
    <li><a class="dropdown-item" href="../articles/vizualizing.html">Vizualizing your Network</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SEELab/enaR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Uncertainty Analysis: Simplest Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SEELab/enaR/blob/master/vignettes/uncertainty_simple.Rmd" class="external-link"><code>vignettes/uncertainty_simple.Rmd</code></a></small>
      <div class="d-none name"><code>uncertainty_simple.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SEELab/enaR" class="external-link">enaR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">limSolve</span><span class="op">)</span></span></code></pre></div>
<p>Here is an example of applying the ENA Uncertainty analysis using the
simplest method – a constant percent error around each flow value</p>
<div class="section level2">
<h2 id="load-the-model-to-analyze">Load the model to analyze<a class="anchor" aria-label="anchor" href="#load-the-model-to-analyze"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">troModels</span><span class="op">)</span>  <span class="co"># load the trophic ecosystem network models include in enaR</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="va">troModels</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span> <span class="co"># cone sping model (Kay et al. 1989; from Tilly)</span></span></code></pre></div>
<p>Next, lets set the Uncertainty Analysis parameters no.samples =
10000, the number of plausible models to return (number of samples) and
f.error = 25 (flow parameters percent error to investigate)</p>
<p>Now we are ready to perform the ENA uncertainty analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no.samples</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">f.error</span> <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="va">m.uncertainty.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/enaUncertainty.html">enaUncertainty</a></span><span class="op">(</span><span class="va">m</span>,                     <span class="co"># original model</span></span>
<span>                                 type <span class="op">=</span> <span class="st">"percent"</span>,      <span class="co"># type of uncertainty to use</span></span>
<span>                                 p.err <span class="op">=</span> <span class="va">f.error</span>,       <span class="co"># define percent error</span></span>
<span>                                 iter <span class="op">=</span> <span class="va">no.samples</span> <span class="op">)</span>    <span class="co"># specify the number of samples</span></span>
<span><span class="co">#&gt; Warning in lsei(E = E, F = F, G = G, H = H): No equalities - setting type = 2</span></span></code></pre></div>
<p>We can then apply selected ENA to the model set. Here we use the
get.ns function to find the whole-network statistics for the models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">m.uncertainty.list</span>, <span class="va">get.ns</span><span class="op">)</span> <span class="co"># get ENA whole network statistics (metrics, indicators)</span></span>
<span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">ns</span><span class="op">)</span><span class="op">)</span>  <span class="co"># reshape data</span></span>
<span></span>
<span><span class="va">ns.original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/get.ns.html">get.ns</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>  <span class="co"># find the original model results.</span></span></code></pre></div>
<p>We can now use these results. First, lets look at a histogram of the
Boundary input values and the Total System throughflow values. This code
generates an orange vertical line on the histogram indicating the
indicator value in the original model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total Boundary Input"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="uncertainty_simple_files/figure-html/uncertsimp4-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"blue2"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total System ThroughFLOW"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="uncertainty_simple_files/figure-html/uncertsimp4-2.png" width="700"></p>
<p>Beyond visualizing the effects of the model flow parameter
uncertainty on the ENA results, we can use the 95% CI to make
statisitcal inferences. Here, we consider the hypothesized “dominance of
indirect effects” (Higashi and Patten 1991, Salas and Borrett 2010,
Borrett et al. 2016), and “network homogenization” (Fath and Patten
1999, Borrett and Salas 2010, Borrett et al. 2016) in ecosystems. To do
this, we first find the 95% confidence intervals for each network
metric:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">id.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">ID.F</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">hmg.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">HMG.O</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span> </span></code></pre></div>
<p>We then construct a bar plot of the calculated values for the
original model and add the 95% CI error bars from Uncertainty
Analysis</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns.original</span><span class="op">$</span><span class="va">ID.F</span>, <span class="va">ns.original</span><span class="op">$</span><span class="va">HMG.O</span><span class="op">)</span>,</span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>          border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indirect/Direct"</span>, <span class="st">"Homogenization"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="co"># threshold value</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>   <span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>   code <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0.2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="uncertainty_simple_files/figure-html/uncertsimp6-1.png" width="700"></p>
<p>The results show that the orignial value of the Indirect-to-Direct
flows ratio is larger than one, indicating the “dominance of indirect
effects”; however, the 95% confidence interval for this indicator with a
25% uniform uncertainty spans the threshold value of 1 (ranging from 0.9
to 1.16). Thus, we are not confident that this parameter exceeds the
interpretation threshold given this level of uncertainty. In contast,
the network homogenizaiton pameter exceeds the interpretation threshold
of 1.0, and the 95% CI for our level of uncertainty suggests that we are
confident that this interpretation is correct.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew K. Lau, S.R. Borrett, D.E. Hines, P. Singh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
