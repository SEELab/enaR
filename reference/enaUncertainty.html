<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Produce a set of plausible network models — enaUncertainty • enaR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Produce a set of plausible network models — enaUncertainty"><meta name="description" content='Connects enaR to limSolve to apply Linear Inverse Modelling to
conduct an uncertainty analysis for Ecological Network
Analysis. Users supply an initial ecosystem model (in the enaR
format) and uncertainty informaiton (several ways of specifying),
and the function returns a list (length = "iter") of balanced
plausible instantiations of the model.  This has been used to
determine the 95
and to determine the statistical significance of selected
comaprisons (Hines et al. 2015, 2016).'><meta property="og:description" content='Connects enaR to limSolve to apply Linear Inverse Modelling to
conduct an uncertainty analysis for Ecological Network
Analysis. Users supply an initial ecosystem model (in the enaR
format) and uncertainty informaiton (several ways of specifying),
and the function returns a list (length = "iter") of balanced
plausible instantiations of the model.  This has been used to
determine the 95
and to determine the statistical significance of selected
comaprisons (Hines et al. 2015, 2016).'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">enaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/enaR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/enterData.html">Entering your Data</a></li>
    <li><a class="dropdown-item" href="../articles/flow_simple.html">Flow Analysis: Simple</a></li>
    <li><a class="dropdown-item" href="../articles/structure_advanced.html">Structure Analysis: Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/structure_simple.html">Structure Analysis: Simple</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_simple.html">Uncertainty Analysis: Simplest Example</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_symmetric.html">Uncertainty Analysis: Symmetric Values</a></li>
    <li><a class="dropdown-item" href="../articles/utility.html">Utility and Mixed Trophic Analyses</a></li>
    <li><a class="dropdown-item" href="../articles/vizualizing.html">Vizualizing your Network</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SEELab/enaR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Produce a set of plausible network models</h1>
      <small class="dont-index">Source: <a href="https://github.com/SEELab/enaR/blob/pkgdown/R/enaUncertainty.R" class="external-link"><code>R/enaUncertainty.R</code></a></small>
      <div class="d-none name"><code>enaUncertainty.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Connects enaR to limSolve to apply Linear Inverse Modelling to
conduct an uncertainty analysis for Ecological Network
Analysis. Users supply an initial ecosystem model (in the enaR
format) and uncertainty informaiton (several ways of specifying),
and the function returns a list (length = "iter") of balanced
plausible instantiations of the model.  This has been used to
determine the 95<!-- % confidnece intervals for network analysis results -->
and to determine the statistical significance of selected
comaprisons (Hines et al. 2015, 2016).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">enaUncertainty</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"network object"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"percent"</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  p.err <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  F.sym <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  z.sym <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y.sym <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  e.sym <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  r.sym <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  F.bot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  z.bot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y.bot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  e.bot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  r.bot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  F.top <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  z.top <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y.top <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  e.top <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  r.top <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a network object.  This includes all weighted flows into and out of each node.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>is a paramter to switch the kind of uncertainty analysis to complete: "percent", "sym", "asym".  The "percent" options explores the parameter space for all parameters by a fixed percentage.  The "sym" options let the user specify an amount to explore around each flow estimate (internal flows (F) and boundary flows (inputs, exports, respirations).  This option assuems that the possible deviation is symmetric around the original values.  The "asym" lets the user specify upper and lower limits for each flow value.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>is the number of plausible models to sample (number of iterations of the sampling algorithm).  The default is 10000, which is often a sufficient sample size for Monte Carlo sampling.</p></dd>


<dt id="arg-p-err">p.err<a class="anchor" aria-label="anchor" href="#arg-p-err"></a></dt>
<dd><p>If the user selects the "percent" type, they must also specify the percent change with this parameter.</p></dd>


<dt id="arg-f-sym">F.sym<a class="anchor" aria-label="anchor" href="#arg-f-sym"></a></dt>
<dd><p>If the user selects the "sym" type, then this parameter specifies the 1/2 the symmetric parameter range for each internal flow.  This should be specified as a data frame in a sparse matrix format with columns identifying the starting node, the target node, and the change value (in same units as flows).</p></dd>


<dt id="arg-z-sym">z.sym<a class="anchor" aria-label="anchor" href="#arg-z-sym"></a></dt>
<dd><p>If the user selects the "sym" type, then this parameter specifies the 1/2 the symmetric parameter range for each input flow. This is specified as a data frame in a sparse matrix format with columns identifying the node number and the change value (in same units as flows).</p></dd>


<dt id="arg-y-sym">y.sym<a class="anchor" aria-label="anchor" href="#arg-y-sym"></a></dt>
<dd><p>If the user selects the "sym" type, then this parameter specifies the 1/2 the symmetric parameter range for each output flows.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and the change value (in same units as flows).</p></dd>


<dt id="arg-e-sym">e.sym<a class="anchor" aria-label="anchor" href="#arg-e-sym"></a></dt>
<dd><p>If the user selects the "sym" type, then this parameter specifies the 1/2 the symmetric parameter range for each export flows.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and the change value (in same units as flows).</p></dd>


<dt id="arg-r-sym">r.sym<a class="anchor" aria-label="anchor" href="#arg-r-sym"></a></dt>
<dd><p>If the user selects the "sym" type, then this parameter specifies the 1/2 the symmetric parameter range for each respiration flows.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and the change value (in same units as flows).</p></dd>


<dt id="arg-f-bot">F.bot<a class="anchor" aria-label="anchor" href="#arg-f-bot"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the minimum possible value for each internal flows.  This should be specified as a data frame in a sparse matrix format with columns identifying the starting node, the target node, and the change value (in same units as flows).</p></dd>


<dt id="arg-z-bot">z.bot<a class="anchor" aria-label="anchor" href="#arg-z-bot"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the minimum value for each non-zero model input.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and minimum value (in same units as flows).</p></dd>


<dt id="arg-y-bot">y.bot<a class="anchor" aria-label="anchor" href="#arg-y-bot"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the minimum value for each non-zero model output.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and minimum value (in same units as flows).</p></dd>


<dt id="arg-e-bot">e.bot<a class="anchor" aria-label="anchor" href="#arg-e-bot"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the minimum value for each non-zero model export.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and minimum value (in same units as flows).</p></dd>


<dt id="arg-r-bot">r.bot<a class="anchor" aria-label="anchor" href="#arg-r-bot"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the minimum value for each non-zero model respiration.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and minimum value (in same units as flows).</p></dd>


<dt id="arg-f-top">F.top<a class="anchor" aria-label="anchor" href="#arg-f-top"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the maximum possible value for each internal flows.  This should be specified as a data frame in a sparse matrix format with columns identifying the starting node, the target node, and the change value (in same units as flows).</p></dd>


<dt id="arg-z-top">z.top<a class="anchor" aria-label="anchor" href="#arg-z-top"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the maximum value for each non-zero model input.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and maximum value (in same units as flows).</p></dd>


<dt id="arg-y-top">y.top<a class="anchor" aria-label="anchor" href="#arg-y-top"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the maximum value for each non-zero model output.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and maximum value (in same units as flows).</p></dd>


<dt id="arg-e-top">e.top<a class="anchor" aria-label="anchor" href="#arg-e-top"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the maximum value for each non-zero model export.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and maximum value (in same units as flows).</p></dd>


<dt id="arg-r-top">r.top<a class="anchor" aria-label="anchor" href="#arg-r-top"></a></dt>
<dd><p>If the user selects the "asym" type, then this data.frame specifies the maximum value for each non-zero model respiration.  This is specified as a data frame in a sparse matrix format with columns identifying the node number and maximum value (in same units as flows).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>plausible.models</dt>
<dd><p>A length=iter list of the plausible models in the network data object format spcified for enaR</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hines, D.E., J.A. Lisa, B. Song, C.R. Tobias, S.R. Borrett. 2015. Estimating the impacts of sea level rise on the coupling of estuarine nitrogen cycling processes through comparative network analysis. Marine Ecology Progress Series 524: 137-154.</p>
<p>Hines, D.E, Singh, P., Borrett, S.R. 2016. Evaluating control of nutrient flow in an estuarine nitrogen cycle through comparative network analysis. Ecological Engineering 89:70-79. doi:10.1016/j.ecoleng.2016.01.009</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David E. Hines</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SEELab/enaR" class="external-link">enaR</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># === INPUT ===</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load model for analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">troModels</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="va">troModels</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span> <span class="co"># cone sping model (Kay et al. 1989; from Tilly)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set Uncertainty Analysis parameters</span></span></span>
<span class="r-in"><span><span class="va">no.samples</span> <span class="op">=</span> <span class="fl">150</span> <span class="co"># the number of plausible models to return (number of samples); </span></span></span>
<span class="r-in"><span>                 <span class="co"># 10,000 would be better.</span></span></span>
<span class="r-in"><span><span class="va">f.error</span> <span class="op">=</span> <span class="fl">25</span>   <span class="co"># flow parameters percent error to investigate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># === ACTION ===</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># peform uncertainty analysis</span></span></span>
<span class="r-in"><span><span class="va">m.uncertainty.list</span> <span class="op">&lt;-</span> <span class="fu">enaUncertainty</span><span class="op">(</span><span class="va">m</span>,                     <span class="co"># original model</span></span></span>
<span class="r-in"><span>                                     type <span class="op">=</span> <span class="st">"percent"</span>,      <span class="co"># type of uncertainty to use</span></span></span>
<span class="r-in"><span>                                    p.err <span class="op">=</span> <span class="va">f.error</span>,       <span class="co"># define percent error</span></span></span>
<span class="r-in"><span>                                     iter <span class="op">=</span> <span class="va">no.samples</span> <span class="op">)</span>    <span class="co"># specify the number of samples</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No equalities - setting type = 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply selected ENA</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">m.uncertainty.list</span>, <span class="va">get.ns</span><span class="op">)</span> <span class="co"># get ENA whole network statstics (metrics, indicators)</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">ns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ns.original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="get.ns.html">get.ns</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># === OUTPUT ===</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lets see how the uncertainty in model flows changed the model inputs and total system throughflow.</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total Boundary Input"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"blue2"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total System ThroughFLOW"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="enaUncertainty-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Lets use the 95% CI to make statisitcal inferences about the</span></span></span>
<span class="r-in"><span><span class="co"># hypothesized "dominance of indirect effects" (Higashi and Patten</span></span></span>
<span class="r-in"><span><span class="co"># 1991, Salas and Borrett 2010, Borrett et al. 2016), and "network</span></span></span>
<span class="r-in"><span><span class="co"># homogenization" (Fath and Patten 1999, Borrett and Salas 2010,</span></span></span>
<span class="r-in"><span><span class="co"># Borrett et al. 2016)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find 95% confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">id.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">ID.F</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hmg.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">HMG.O</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barplot of the calculated values for the original model</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns.original</span><span class="op">$</span><span class="va">ID.F</span>, <span class="va">ns.original</span><span class="op">$</span><span class="va">HMG.O</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>              border <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>              names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indirect/Direct"</span>, <span class="st">"Homogenization"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="co"># threshold value</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add 95CI error bars from Uncertainty Analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      code <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0.2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># === OUTPUT ===</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lets see how the uncertainty in model flows changed the model inputs and total system throughflow.</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="enaUncertainty-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total Boundary Input"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">Boundary</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"blue2"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">"Total System ThroughFLOW"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ns.original</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="enaUncertainty-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Lets use the 95% CI to make statisitcal inferences about the</span></span></span>
<span class="r-in"><span><span class="co"># hypothesized "dominance of indirect effects" (Higashi and Patten</span></span></span>
<span class="r-in"><span><span class="co"># 1991, Salas and Borrett 2010, Borrett et al. 2016), and "network</span></span></span>
<span class="r-in"><span><span class="co"># homogenization" (Fath and Patten 1999, Borrett and Salas 2010,</span></span></span>
<span class="r-in"><span><span class="co"># Borrett et al. 2016)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find 95% confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">id.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">ID.F</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hmg.95ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">HMG.O</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns.original</span><span class="op">$</span><span class="va">ID.F</span>, <span class="va">ns.original</span><span class="op">$</span><span class="va">HMG.O</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         col <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>             border <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>             names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indirect/Direct"</span>, <span class="st">"Homogenization"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="co"># threshold value</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add 95CI error bars from Uncertainty Analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       <span class="va">bp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">hmg.95ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       code <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0.2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The results show that the orignial value of the Indirect-to-Direct</span></span></span>
<span class="r-in"><span><span class="co"># flows ratio is larger than one, indicating the "dominance of</span></span></span>
<span class="r-in"><span><span class="co"># indirect effects"; however, the 95% confidence interval for this</span></span></span>
<span class="r-in"><span><span class="co"># indicator with a 25% uniform uncertainty spans the threshold value</span></span></span>
<span class="r-in"><span><span class="co"># of 1 (ranging from 0.9 to 1.16).  Thus, we are not confident that</span></span></span>
<span class="r-in"><span><span class="co"># this parameter exceeds the interpretation threshold given this</span></span></span>
<span class="r-in"><span><span class="co"># level of uncertainty.  In contast, the network homogenizaiton</span></span></span>
<span class="r-in"><span><span class="co"># pameter exceeds the interpretation threshold of 1.0, and the 95% CI</span></span></span>
<span class="r-in"><span><span class="co"># for our level of uncertainty suggests that we are confident that</span></span></span>
<span class="r-in"><span><span class="co"># this interpretation is correct.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ns</span><span class="op">$</span><span class="va">TST</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="enaUncertainty-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew K. Lau, S.R. Borrett, D.E. Hines, P. Singh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

